# Dev Log â€” 2025-09-09

> Branch/Scope: Core + Godot UI  
> Commit: `7dd55526`ï¼ˆRecipe é¸æ“‡ UI ä¸²æ¥ / Issue #15 æœ€å°å¯¦ä½œï¼‰

---

## ğŸ¯ ä»Šæ—¥é‡é»ï¼ˆDoneï¼‰
- **Recipe é¸æ“‡æµç¨‹æ‰“é€šï¼ˆIssue #15ï¼‰**
  - æ–°å¢æ¥µè–„ **RecipeSystem**ï¼šæä¾›ä»¥ `patternKey:int` å…¨æƒæ `RecipeRegistry` çš„æŸ¥è©¢ï¼ˆä¸å« unlock/gating/cooldownï¼‰ã€‚
  - **PatternExtractor**ï¼šæ¡ç›´è§€åé€²ä½éµï¼ˆAB-only, 1â€“3Lï¼‰ï¼Œç”¢å‡º pattern key èˆ‡ labelï¼ˆå¦‚ `A+B`ï¼‰ã€‚
  - **UIï¼ˆRecallPanelï¼‰**ï¼š
    - `Check`ï¼šç”± Timeline é¸æ“‡ â†’ `patternKey` â†’ RecipeSystem å…¨æƒæ â†’ **ItemList** åˆ—å‡ºå€™é¸ï¼Œä¸¦åœ¨**é è¦½å¡æ§½**é¡¯ç¤ºåç¨±/æ¨™ç±¤/æ‘˜è¦ã€‚
    - **é è¨­é¸æ“‡**ï¼šè‹¥å­˜åœ¨ `expectedId = patternKey * 10 + 1`ï¼ˆä¾‹å¦‚ `AA(11)â†’111`ï¼‰ï¼Œå‰‡å„ªå…ˆï¼›å¦å‰‡å–ç¬¬ä¸€ç­†ï¼ˆ`recipeId` å‡å†ªï¼‰ã€‚
    - `Confirm`ï¼šé€å‡º `RecallIntent`ï¼ˆä»¥ **é¸ä¸­ recipeId** ç‚ºæº–ï¼‰ã€‚
- **RecipeRegistry æ¨£æœ¬è£œé½Šï¼ˆ2L Echoï¼‰**
  - `AA â†’ 111/112`ã€`AB â†’ 121`ã€`BA â†’ 211/212`ã€`BB â†’ 221`ï¼ˆå«åç¨±ã€æ¨™ç±¤ã€æ‘˜è¦ï¼‰ã€‚
- **æµç¨‹é©—è­‰**
  - å¯¦æ©Ÿ log é¡¯ç¤ºï¼šCheck èƒ½æ‰¾åˆ° 2 ç­†å€™é¸ï¼ˆå¦‚ `AA`â†’`111/112`ã€`BA`â†’`211/212`ï¼‰ï¼Œå¤šæ¬¡åˆ‡æ›å¾Œ **Confirm æ­£ç¢ºé€å‡ºé¸ä¸­ idï¼ˆå¦‚ 112ï¼‰**ï¼Œæ ¸å¿ƒæ¥å—ä¸¦å›å‚³æˆåŠŸã€‚

---

## ğŸ“œ ä»£è¡¨æ€§åŸ·è¡Œç´€éŒ„ï¼ˆç¯€éŒ„ï¼‰
[RecallPanel] Check pressed with selection: [0, 1]
[RecallPanel] Found 2 candidate recipes
[RecallPanel] Selected Recipe: 112
[RecallPanel] Confirm with selected recipeId: 112
[Combat] OnRecallConfirm: recipeId=112
[PhaseRunner] Accepting player action: RecallIntent { ... RecipeId = 112 }
[Dequeued]: Player: RecallIntent { ... RecipeId = 112 }
Player recalled RecipeId[112]
[Combat] Recall result: WaitInput, Step: PlayerInput



---

## ğŸ§© è¦æ ¼/æ±ºç­–æ›´æ–°
- **PatternKey**ï¼šAB-only åé€²ä½ï¼ˆ`A=1, B=2`ï¼‰ï¼Œé•·åº¦ 1â€“3ï¼›C æš«ä¸è™•ç†ï¼ˆå·²é ç•™æœªä¾†æ“´å……ï¼‰ã€‚
- **é è¨­å€™é¸è¦å‰‡**ï¼š`expectedId = patternKey * 10 + 1`ï¼›è‹¥ä¸å­˜åœ¨å‰‡é¸æœ€å° `recipeId`ã€‚
- **æœ¬éšæ®µä¸ç´å…¥**ï¼šunlock/gating/cooldownï¼ˆä¹‹å¾Œä»¥ Provider ä»‹é¢æ“´å……ï¼‰ã€‚

---

## ğŸ æ—¢çŸ¥äº‹é … / é¢¨éšª
- **å…¨æƒææ•ˆèƒ½**ï¼šç›®å‰æ¯æ¬¡ Check æ‰æƒ Registryï¼Œé‡å¤§å¾Œéœ€ä»¥ `label â†’ ids[]` å»ºç´¢å¼•ã€‚
- **UI å£“æ¸¬**ï¼šæ‰‹å‹•é€£é»ç„¡å•é¡Œï¼Œä½†ä»å»ºè­°å¾ŒçºŒåŠ å…¥ï¼ˆå¯é¸ï¼‰é˜²æŠ–/å–®ç™¼ä¿è­·ã€‚
- **ä¸€è‡´æ€§**ï¼šè«‹ç¶­æŒå€™é¸æ’åºä»¥ `recipeId` å‡å†ªï¼Œç¢ºä¿é è¨­é¸æ“‡ç©©å®šã€‚

---

## âœ… å¾…è¾¦ï¼ˆæ˜æ—¥å„ªå…ˆï¼‰
1. **å»ºç´¢å¼•ï¼ˆInit æ™‚ï¼‰**ï¼š`IndexByLabel: "A+B" â†’ int[] recipeIds`ï¼Œæ›¿ä»£æ¯æ¬¡å…¨æƒæã€‚
2. **å–®å…ƒæ¸¬è©¦ï¼ˆæœ€å°ï¼‰**
   - `PatternExtractor`ï¼š`[A,B]â†’12`ã€`[B,A]â†’21`ã€å¿½ç•¥ Cã€é•·åº¦é‚Šç•Œã€‚
   - `RecipeSystem.GetRecipesByPattern`ï¼šæ­£ç¢ºæ¯”å° labelã€æ’åºã€ç„¡åŒ¹é…è¿”å›ç©ºã€‚
3. **UI ç©©å®šåŒ–ï¼ˆå¯é¸ï¼‰**ï¼šCheck é˜²æŠ–ï¼ˆ80msï¼‰ã€Confirm å–®ç™¼ã€åŒ key ä¸é‡ç®—ã€‚

---

## ğŸ“¦ è®Šæ›´æ‘˜è¦
- æ–°ï¼š`RecipeSystem`ï¼ˆè–„å±¤ï¼Œpatternâ†’å…¨æƒæâ†’å€™é¸ï¼‰
- æ–°/æ”¹ï¼š`PatternExtractor`ï¼ˆåé€²ä½éµï¼ŒAB-onlyï¼‰
- æ”¹ï¼š`RecipeRegistry`ï¼ˆè£œ 2L Echoï¼š111/112/121/211/212/221ï¼›æŸ¥è©¢ä»‹é¢ï¼‰
- æ”¹ï¼š`RecallPanel`ï¼ˆCheckâ†’åˆ—å€™é¸â†’é è¦½â†’Confirm é€é¸ä¸­ recipeIdï¼‰

---

## ğŸ§­ ä¸‹ä¸€æ­¥ï¼ˆv0.6 å‰ç½®ï¼‰
- Provider ä»‹é¢åŒ–ï¼šæœªä¾†æ›ä¸Š **unlock/gating/cooldown** ä¸å‹• UIã€‚
- è‹¥è¦æ¨¡æ“´å¤§ï¼Œå†è©•ä¼° `ItemList` â†’ `OptionButton/Popup`ã€‚

_å‚™è¨»ï¼šä»Šæ—¥ä¸»è¦å°ˆæ³¨åœ¨ Issue #15 çš„æœ€å°é–‰ç’°ï¼Œå·²å¯åœ¨å¯¦æ©Ÿæµç¨‹ä¸­ç©©å®šä½¿ç”¨ã€‚_
