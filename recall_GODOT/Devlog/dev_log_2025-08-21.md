📊 今日進度統整 - 2025-08-21
🎯 核心議題：將軍對決玩法設計
💡 重要發現與決策
1. 執行順序對遊戲邏輯的影響分析

初步假設：順序執行 vs 同時執行沒有差別
關鍵發現：由於存在 死亡判定機制，執行順序會有顯著影響
遊戲設計：玩家優先執行 → 可以先手擊殺敵人 → 敵人死後行動取消

2. 架構設計方案確認
經過對比分析 Actor 持有 Intent vs Pipeline Queue 兩種方案：

最終選擇：基於現有 IntentQueue.cs 的 Pipeline Queue 方案
理由：更適合將軍對決的"收集計劃 → 批次執行"語義

3. 關鍵邏輯漏洞發現
在準備改玩法時發現：死亡後行為消滅機制缺失

問題：當前 ExecuteOrDiscard 只檢查 AP，不檢查死亡狀態
影響：死亡的敵人仍可執行攻擊，失去先手擊殺的戰略意義

🔧 技術解決方案
✅ 已確定的修復方案
1. ExecuteOrDiscard 死亡檢查
csharp// 在 AP 檢查前添加死亡檢查
foreach (var cmd in batch)
{
    if (cmd.Source != null && !cmd.Source.IsAlive)
    {
        return ExecResult.Fail(FailCode.SelfDead);
    }
}
2. 以 Intent 為單位的處理邏輯

核心洞察：按 Intent 逐個處理，自然解決多敵人場景
流程：Pop Intent → 檢查存活 → Translate → Execute → 下一個
優勢：保持現有 ExecuteOrDiscard 邏輯不變

🎮 玩法流程設計
修改後的 Phase 流程
TurnStart 
  → EnemyPlanning (Intent 入隊到 EnemyDelayedQueue，不立即執行)
  → PlayerPlanning (Intent 入隊到 PlayerQueue)  
  → PlayerExecute (執行 PlayerQueue，玩家先手)
  → EnemyExecDelayed (執行 EnemyDelayedQueue，敵人後手)
  → TurnEnd
戰略意義

先手擊殺：玩家可通過精確計算實現一擊致命
風險管理：降低同歸於盡風險
策略深度：需要計算敵人血量和自身能力